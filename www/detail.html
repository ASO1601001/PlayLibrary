<ons-page id="add_play">
  <div class="page__background" style="background-image:url('img/background.png');background-repeat: no-repeat;background-position: 50% 50%;background-attachment:fixed;"></div>
	<ons-toolbar>
		<div class="left">
			<ons-toolbar-button onclick="fn.open()">
				<ons-icon icon="ion-navicon, material:md-menu"></ons-icon>
			</ons-toolbar-button>
		</div>
		<div class="center">
			詳細
		</div>
	</ons-toolbar>
<div class="wrap">
	<div class="paddi">
		
		<h2 id="dplay_name">遊びの名前</h2>
    <p id="dplay_sub"></p><br>
    <ul>
      <li>推奨年齢<p id="dage"></p></li>
      <li>推奨人数<p id="dpeaple"></p></li>
      <li>所要時間<p id="dtime"></p></li>
      <li>場所<p id="dplace"></p></li>
    </ul>
    
    <div>
      <h3>準備する物</h3>
      <ol>
        <li><span id="show_pre_thing0"></span></li>
        <li><span id="show_pre_thing1"></span></li>
        <li><span id="show_pre_thing2"></span></li>
      </ol>
    </div>

    <div>
      <h3>ステップ</h3>
      <ol>
        <li><span id="show_step1"></span></li>
        <li><span id="show_step2"></span></li>
        <li><span id="show_step3"></span></li>
      </ol>
    </div>
</div>
<script>
  document.addEventListener("init", function(event) {
    var page = event.target;  // initイベントが発生したページ
    var play_det_id = new String(page.data.param1); //detailメソッドで送られたparam1を取得
    firebase.firestore().collection('plays').doc(play_det_id.toString()).get().then(function(doc){
      document.getElementById('dplay_name').innerHTML = doc.data().name;
      document.getElementById('dage').innerHTML = doc.data().best_age;
      document.getElementById('dpeaple').innerHTML = doc.data().best_peaple;
      document.getElementById('dtime').innerHTML = doc.data().minuts;
      if(doc.data().place != null){
        document.getElementById('dplace').innerHTML = doc.data().place;
      }
    });
    firebase.firestore().collection('things').doc(play_det_id.toString()).get().then(function(doc){
      doc.data().thing.forEach(function( value,index ) {
        document.getElementById('show_pre_thing'+index).innerHTML = value;
      });
    });
    firebase.firestore().collection('steps').doc(play_det_id.toString()).get().then(function(doc){
      doc.data().step1.forEach(function( value,index ) {
        if(index==0){
          document.getElementById('show_step1').innerHTML = value;
        }
      });
      doc.data().step2.forEach(function( value,index ) {
        if(index==0){
          document.getElementById('show_step2').innerHTML = value;
        }
      });
      doc.data().step3.forEach(function( value,index ) {
        if(index==0){
          document.getElementById('show_step3').innerHTML = value;
        }
      });
    });
  });
</script>
</ons-page>